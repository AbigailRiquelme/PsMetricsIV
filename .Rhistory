educ_jefe= rep(mean(data_d$educ_jefe), k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
jmujer= rep(1,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
pred_jh <- predict(desercion_probit, newdata = data.frame(mujer=rep(1,k),
educ_jefe= rep(mean(data_d$educ_jefe), k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
jmujer= rep(0,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
df_final <- data.frame(
pred_jm, pred_jh, pred_hombre, pred_mujer)
ggplot(aes(x = ingreso, y = pred_jm), data = df_final) +
geom_line(aes(x=ingreso, y = pred_jh), col = "burlywood2", size = 1) +
ggtitle("Morosidad en función retraso de 60-89 días en el pago") +
xlab("Cantidad de veces que se retrasó")+
ylab("Predicción")+
theme_bw()
prueba <- df_final$pred_hombre-df_final$pred_mujer
prueba
ggplot(aes(x = ingreso, y = pred_jm), data = df_final) +
geom_line(aes(x=ingreso, y = pred_jh), col = "burlywood2", size = 1) +
geom_line(aes(x = ingreso, y = pred_jm), col = "azure3", size = 1) +
ggtitle("Morosidad en función retraso de 60-89 días en el pago") +
xlab("Cantidad de veces que se retrasó")+
ylab("Predicción")+
theme_bw()
ggplot(aes(x = ingreso, y = pred_jm), data = df_final) +
geom_line(aes(x=ingreso, y = pred_jh), col = "burlywood2", size = 1) +
geom_line(aes(x = ingreso, y = pred_jm), col = "azure3", size = 1) +
ggtitle("") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()
ggplot(aes(x = ingreso, y = pred_mujer), data = df_final) +
geom_line(aes(x=ingreso, y = pred_mujer), col = "burlywood2", size = 1) +
geom_line(aes(x = ingreso, y = pred_hombre), col = "azure3", size = 1) +
ggtitle("") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()
desercion_probit <- glm(modelo_desercion , family = binomial(link = "probit"),
data = data_d)
ingreso <- seq(0,100000,100)
k <- length(ingreso)
pred_mujer <- predict(desercion_probit, newdata = data.frame(mujer=rep(1,k),
educ_jefe= rep(mean(data_d$educ_jefe), k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
jmujer= rep(1,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
pred_hombre <- predict(desercion_probit, newdata = data.frame(mujer=rep(0,k),
educ_jefe= rep(mean(data_d$educ_jefe), k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
jmujer= rep(1,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
pred_jm <- predict(desercion_probit, newdata = data.frame(mujer=rep(1,k),
educ_jefe= rep(mean(data_d$educ_jefe), k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
jmujer= rep(1,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
pred_jh <- predict(desercion_probit, newdata = data.frame(mujer=rep(1,k),
educ_jefe= rep(mean(data_d$educ_jefe), k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
jmujer= rep(0,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
df_final <- data.frame(
pred_jm, pred_jh, pred_hombre, pred_mujer)
ggplot(aes(x = ingreso, y = pred_jm), data = df_final) +
geom_line(aes(x=ingreso, y = pred_jh), col = "burlywood2", size = 1) +
geom_line(aes(x = ingreso, y = pred_jm), col = "azure3", size = 1) +
ggtitle("") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()
ggplot(aes(x = ingreso, y = pred_mujer), data = df_final) +
geom_line(aes(x=ingreso, y = pred_mujer), col = "burlywood2", size = 1) +
geom_line(aes(x = ingreso, y = pred_hombre), col = "azure3", size = 1) +
ggtitle("") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()
ingreso <- seq(0,100000,100)
k <- length(ingreso)
pred_mujer <- predict(desercion_probit, newdata = data.frame(mujer=rep(1,k),
educ_jefe= rep(mean(data_d$educ_jefe), k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
jmujer= rep(1,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
clear
dir <-
dir <- "/Users/Abi/Documents/GitHub/PsMetricsIV"
dir <-
setwd(dir)
library(haven)
data <- read_dta("https://econometriaudesa.weebly.com/uploads/1/3/6/3/136372338/cuarto_trim_2019.dta")
data <- read_dta("cuarto_trim_2019.dta")
library(fastDummies)
data_d <- dummy_cols(data, select_columns = "ch11")
library(Formula)
modelo_desercion <- Formula(deserta ~ mujer + educ_jefe + hermanos + ingreso_per_capita + jmujer +
ch11_0 + ch11_1 + ch11_9 )
desercion_probit <- glm(modelo_desercion , family = binomial(link = "probit"),
data = data_d)
library(lmtest)
library(sandwich)
desercion_probit_robust <-  coeftest(desercion_probit, vcov = vcovHC(desercion_probit, "HC1"))
summary(desercion_probit_robust)
marginal_media <- probitmfx(deserta ~ mujer + educ_jefe + hermanos + ingreso_per_capita + jmujer +
ch11_0 + ch11_1 + ch11_9 , data = data_d,
atmean = TRUE, robust = TRUE)
prueba1 <- margins(myprobit, at = list(mujer = 0:1))
prueba2 <- margins(myprobit, at = list(mujer = median(data_d$mujer), educ_jefe = median(data_d$educ_jefe),
hermanos = median(data_d$hermanos), ingreso_per_capita = median(data_d$ingreso_per_capita),
jmujer = median(data_d$jmujer), ch11_0 = median(data_d$ch11_0), ch11_1 = median(data_d$ch11_1), ch11_9 = median(data_d$ch11_9)))
prueba3 <- margins(myprobit, at = list(mujer = mfv(data_d$mujer), educ_jefe = mfv(data_d$educ_jefe),
hermanos = mfv(data_d$hermanos), ingreso_per_capita = mfv(data_d$ingreso_per_capita),
jmujer = mfv(data_d$jmujer), ch11_0 = mfv(data_d$ch11_0), ch11_1 = mfv(data_d$ch11_1), ch11_9 = mfv(data_d$ch11_9)))
prueba4 <- margins(myprobit, at = list(mujer = mfv(data_d$mujer), educ_jefe = min(data_d$educ_jefe),
hermanos = min(data_d$hermanos), ingreso_per_capita = min(data_d$ingreso_per_capita),
jmujer = mfv(data_d$jmujer), ch11_0 = mfv(data_d$ch11_0), ch11_1 = mfv(data_d$ch11_1), ch11_9 = mfv(data_d$ch11_9)))
desercion_mlp <- lm(modelo_desercion, data = data_d)
desercion_mlp_robust <- coeftest(desercion_mlp, vcov = vcovHC(desercion_mlp, "HC1"))
data_d$ingreso_per_capita[data_d$ingreso_per_capita == 0] <- 1
data_d$ln_ing <- log(data_d$ingreso_per_capita, base = exp(1))
stargazer(desercion_probit_robust, desercion_mlp_robust, type='text',
dep.var.labels=c("Deserta", "Deserta"),
notes = "Robust standard errors in parentheses")
ingreso <- seq(0,100000,100)
k <- length(ingreso)
pred_mujer <- predict(desercion_probit, newdata = data.frame(mujer=rep(1,k),
educ_jefe= rep(mean(data_d$educ_jefe), k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
jmujer= rep(1,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
pred_hombre <- predict(desercion_probit, newdata = data.frame(mujer=rep(0,k),
educ_jefe= rep(mean(data_d$educ_jefe), k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
jmujer= rep(1,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
pred_jm <- predict(desercion_probit, newdata = data.frame(mujer=rep(1,k),
educ_jefe= rep(mean(data_d$educ_jefe), k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
jmujer= rep(1,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
pred_jh <- predict(desercion_probit, newdata = data.frame(mujer=rep(1,k),
educ_jefe= rep(mean(data_d$educ_jefe), k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
jmujer= rep(0,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
df_final <- data.frame(
pred_jm, pred_jh, pred_hombre, pred_mujer)
ggplot(aes(x = ingreso, y = pred_jm), data = df_final) +
geom_line(aes(x=ingreso, y = pred_jh), col = "burlywood2", size = 1) +
geom_line(aes(x = ingreso, y = pred_jm), col = "azure3", size = 1) +
ggtitle("") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()
ggplot(aes(x = ingreso, y = pred_mujer), data = df_final) +
geom_line(aes(x=ingreso, y = pred_mujer), col = "burlywood2", size = 1) +
geom_line(aes(x = ingreso, y = pred_hombre), col = "azure3", size = 1) +
ggtitle("") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()
ggplot(aes(x = ingreso, y = pred_jm), data = df_final) +
geom_line(aes(x=ingreso, y = pred_jh), col = "burlywood2", size = 1) +
geom_line(aes(x = ingreso, y = pred_jm), col = "azure3", size = 1) +
ggtitle("Probabilidad de deserción en función del ingreso para hombres y mujeres") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()
ggplot(aes(x = ingreso, y = pred_mujer), data = df_final) +
geom_line(aes(x=ingreso, y = pred_mujer), col = "burlywood2", size = 1) +
geom_line(aes(x = ingreso, y = pred_hombre), col = "azure3", size = 1) +
ggtitle("Probabilidad de deserción en función del ingreso para jefes de hogar hombres y mujeres") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()
ggplot(aes(x = ingreso, y = pred_mujer), data = df_final) +
geom_line(aes(x=ingreso, y = pred_mujer), col = "burlywood2", size = 1) +
geom_line(aes(x = ingreso, y = pred_hombre), col = "azure3", size = 1) +
ggtitle("Probabilidad de deserción en función del ingreso para jefes de hogar") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()
?ggplot
ggplot(aes(x = ingreso, y = pred_mujer), data = df_final) +
geom_line(aes(x=ingreso, y = pred_mujer), col = "burlywood2", size = 1) +
geom_line(aes(x = ingreso, y = pred_hombre), col = "azure3", size = 1) +
ggtitle("Probabilidad de deserción en función del ingreso para jefes de hogar") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()+
theme(legend.position="bottom", legend.box = "horizontal")
ggplot(aes(x = ingreso, y = pred_mujer), data = df_final) +
geom_line(aes(x=ingreso, y = pred_mujer), col = "burlywood2", size = 1) +
geom_line(aes(x = ingreso, y = pred_hombre), col = "azure3", size = 1) +
ggtitle("Probabilidad de deserción en función del ingreso para jefes de hogar") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme(legend.position="bottom", legend.box = "horizontal")
theme_bw()+
ggplot(aes(x = ingreso, y = pred_mujer), data = df_final) +
geom_line(aes(x=ingreso, y = pred_mujer), col = "burlywood2", size = 1) +
geom_line(aes(x = ingreso, y = pred_hombre), col = "azure3", size = 1) +
ggtitle("Probabilidad de deserción en función del ingreso para jefes de hogar") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()+
theme(legend.position="bottom", legend.box = "horizontal")
ggplot(aes(x = ingreso, y = pred_mujer), data = df_final) +
geom_line(aes(x=ingreso, y = pred_mujer), col = "burlywood2", size = 1) +
geom_line(aes(x = ingreso, y = pred_hombre), col = "azure3", size = 1) +
ggtitle("Probabilidad de deserción en función del ingreso para jefes de hogar") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()
ggplot(aes(x = ingreso, y = pred_mujer), data = df_final) +
geom_line(aes(x=ingreso, y = pred_mujer), col = "burlywood2", size = 1) +
geom_line(aes(x = ingreso, y = pred_hombre), col = "azure3", size = 1) +
scale_color_manual(name = "Sexo", values = c("Mujer" = "burlywood2", "Hombre" = "azure3"))+
ggtitle("Probabilidad de deserción en función del ingreso para jefes de hogar") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()
ggplot(aes(x = ingreso, y = pred_mujer), data = df_final) +
geom_line(aes(x=ingreso, y = pred_mujer), col = "burlywood2", size = 1) +
geom_line(aes(x = ingreso, y = pred_hombre), col = "azure3", size = 1) +
scale_color_manual(name = "Sexo", values = c("Mujer" = "burlywood2", "Hombre" = "azure3"))+
ggtitle("Probabilidad de deserción en función del ingreso para jefes de hogar") +
xlab("Ingreso per capita")+
ylab("Predicción")
ggplot()+
geom_line(data=df_final,aes(y=pred_mujer,x= ingreso,colour="Y1"),size=1 )+
geom_line(data=df_final,aes(y=pred_hombre,x= ingreso,colour="Y2"),size=1) +
scale_color_manual(name = "Y series", values = c("Y1" = "darkblue", "Y2" = "red"))
ggplot()+
geom_line(data=df_final,aes(y=pred_mujer,x= ingreso,colour="Y1"),size=1 )+
geom_line(data=df_final,aes(y=pred_hombre,x= ingreso,colour="Y2"),size=1) +
scale_color_manual(name = "Y series", values = c("Y1" = "darkblue", "Y2" = "red"))+
ggtitle("Probabilidad de deserción en función del ingreso para jefes de hogar") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()
ggplot()+
geom_line(data=df_final,aes(y=pred_mujer,x= ingreso,colour="Y1"),size=1 )+
geom_line(data=df_final,aes(y=pred_hombre,x= ingreso,colour="Y2"),size=1) +
scale_color_manual(name = "Y series", values = c("Mujer" = "darkblue", "Hombre" = "red"))+
ggtitle("Probabilidad de deserción en función del ingreso para jefes de hogar") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()
ggplot()+
geom_line(data=df_final,aes(y=pred_mujer,x= ingreso,colour="Mujer"),size=1 )+
geom_line(data=df_final,aes(y=pred_hombre,x= ingreso,colour="Hombre"),size=1) +
scale_color_manual(name = "Y series", values = c("Mujer" = "darkblue", "Hombre" = "red"))+
ggtitle("Probabilidad de deserción en función del ingreso para jefes de hogar") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()
ggplot()+
geom_line(data=df_final,aes(y=pred_mujer,x= ingreso,colour="Mujer"),size=1 )+
geom_line(data=df_final,aes(y=pred_hombre,x= ingreso,colour="Hombre"),size=1) +
scale_color_manual(name = "Y series", values = c("Mujer" = "burlywood2", "Hombre" = "azure3"))+
ggtitle("Probabilidad de deserción en función del ingreso para jefes de hogar") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()
ggplot()+
geom_line(data=df_final,aes(y=pred_mujer,x= ingreso,colour="Mujer"),size=1 )+
geom_line(data=df_final,aes(y=pred_hombre,x= ingreso,colour="Hombre"),size=1) +
scale_color_manual(name = "Sexo", values = c("Mujer" = "burlywood2", "Hombre" = "azure3"))+
ggtitle("Probabilidad de deserción en función del ingreso para jefes de hogar") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()
ggplot()+
geom_line(data=df_final,aes(y=pred_mujer,x= ingreso,colour="Mujer"),size=1 )+
geom_line(data=df_final,aes(y=pred_hombre,x= ingreso,colour="Hombre"),size=1) +
scale_color_manual(name = "Sexo", values = c("Mujer" = "burlywood2", "Hombre" = "azure3"))+
ggtitle("Probabilidad de deserción en función del ingreso para jefes de hogar") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()
ggplot()+
geom_line(data=df_final,aes(y=pred_mujer,x= ingreso,colour="Mujer"),size=1 )+
geom_line(data=df_final,aes(y=pred_hombre,x= ingreso,colour="Hombre"),size=1) +
scale_color_manual(name = "Sexo", values = c("Mujer" = "burlywood2", "Hombre" = "azure3"))+
ggtitle("Probabilidad de deserción en función del ingreso para jefes de hogar") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()
ggplot()+
geom_line(data=df_final,aes(y=pred_jm,x= ingreso,colour="Mujer"),size=1 )+
geom_line(data=df_final,aes(y=pred_jh,x= ingreso,colour="Hombre"),size=1) +
scale_color_manual(name = "Jefe de hogar", values = c("Mujer" = "burlywood2", "Hombre" = "azure3"))+
ggtitle("Probabilidad de deserción en función del ingreso para jefes de hogar") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()
ggsave(file="jefehogar.eps", width=6.5, height=4, dpi=300)
ggsave(file="sexo.eps", width=6.5, height=4, dpi=300)
dir <-
dir <- "/Users/Abi/Documents/GitHub/PsMetricsIV"
dir <-
setwd(dir)
library(haven)
data <- read_dta("https://econometriaudesa.weebly.com/uploads/1/3/6/3/136372338/cuarto_trim_2019.dta")
library(fastDummies)
data_d <- dummy_cols(data, select_columns = "ch11")
View(data)
data_d <- dummy_cols(data, select_columns = "ch11","educ_jefe")
library(fastDummies)
data_d <- dummy_cols(data, select_columns = "ch11","educ_jefe")
data_d <- dummy_cols(data, select_columns = "ch11")
dir <-
dir <- "/Users/Abi/Documents/GitHub/PsMetricsIV"
dir <-
dir <- "/Users/Abi/Documents/GitHub/PsMetricsIV"
dir <-
setwd(dir)
library(haven)
data <- read_dta("https://econometriaudesa.weebly.com/uploads/1/3/6/3/136372338/cuarto_trim_2019.dta")
library(fastDummies)
data_d <- dummy_cols(data, select_columns = "ch11")
data_d <- dummy_cols(data, select_columns = "educ_jefe")
dir <-
dir <- "/Users/Abi/Documents/GitHub/PsMetricsIV"
dir <-
setwd(dir)
library(haven)
data <- read_dta("https://econometriaudesa.weebly.com/uploads/1/3/6/3/136372338/cuarto_trim_2019.dta")
library(fastDummies)
data_d <- dummy_cols(data, select_columns = "ch11")
data_d <- dummy_cols(datad, select_columns = "educ_jefe")
data_d <- dummy_cols(data, select_columns = "ch11")
data_d <- dummy_cols(datad, select_columns = "educ_jefe")
data_d <- dummy_cols(data_d, select_columns = "educ_jefe")
View(data_d)
modelo_desercion <- Formula(deserta ~ mujer + educ_jefe_0 + educ_jefe_3 + educ_jefe_4 + educ_jefe_5 + educ_jefe_6 + educ_jefe_7 + hermanos + ingreso_per_capita + jmujer +
ch11_0 + ch11_1 + ch11_9)
library(Formula)
modelo_desercion <- Formula(deserta ~ mujer + educ_jefe_0 + educ_jefe_3 + educ_jefe_4 + educ_jefe_5 + educ_jefe_6 + educ_jefe_7 + hermanos + ingreso_per_capita + jmujer +
ch11_0 + ch11_1 + ch11_9)
desercion_probit <- glm(modelo_desercion , family = binomial(link = "probit"),
data = data_d)
library(lmtest)
library(sandwich)
desercion_probit_robust <-  coeftest(desercion_probit, vcov = vcovHC(desercion_probit, "HC1"))
summary(desercion_probit_robust)
marginal_media <- probitmfx(deserta ~ mujer + educ_jefe_0 + educ_jefe_3 + educ_jefe_4 + educ_jefe_5 + educ_jefe_6 + educ_jefe_7 + hermanos + ingreso_per_capita + jmujer +
ch11_0 + ch11_1 + ch11_9, data = data_d,
atmean = TRUE, robust = TRUE)
library(lmtest)
library(sandwich)
desercion_probit_robust <-  coeftest(desercion_probit, vcov = vcovHC(desercion_probit, "HC1"))
summary(desercion_probit_robust)
marginal_media <- probitmfx(deserta ~ mujer + educ_jefe_0 + educ_jefe_3 + educ_jefe_4 + educ_jefe_5 + educ_jefe_6 + educ_jefe_7 + hermanos + ingreso_per_capita + jmujer +
ch11_0 + ch11_1 + ch11_9, data = data_d,
atmean = TRUE, robust = TRUE)
library(mfx)
marginal_media <- probitmfx(deserta ~ mujer + educ_jefe_0 + educ_jefe_3 + educ_jefe_4 + educ_jefe_5 + educ_jefe_6 + educ_jefe_7 + hermanos + ingreso_per_capita + jmujer +
ch11_0 + ch11_1 + ch11_9, data = data_d,
atmean = TRUE, robust = TRUE)
prueba1 <- margins(myprobit, at = list(mujer = 0:1))
library(margins)
prueba1 <- margins(myprobit, at = list(mujer = 0:1))
prueba1 <- margins(desercion_probit, at = list(mujer = 0:1))
prueba2 <- margins(desercion_probit, at = list(mujer = median(data_d$mujer), educ_jefe = median(data_d$educ_jefe),
hermanos = median(data_d$hermanos), educ_jefe_0 = median(data_d$educ_jefe_0), educ_jefe_3 = median(data_d$educ_jefe_3),
educ_jefe_4 = median(data_d$educ_jefe_4), educ_jefe_5 = median(data_d$educ_jefe_5), educ_jefe_6 = median(data_d$educ_jefe_6),
educ_jefe_7 = median(data_d$educ_jefe_7), ingreso_per_capita = median(data_d$ingreso_per_capita), jmujer = median(data_d$jmujer),
ch11_0 = median(data_d$ch11_0), ch11_1 = median(data_d$ch11_1), ch11_9 = median(data_d$ch11_9)))
prueba3 <- margins(myprobit, at = list(mujer = mfv(data_d$mujer), educ_jefe = mfv(data_d$educ_jefe),
hermanos = mfv(data_d$hermanos), ingreso_per_capita = mfv(data_d$ingreso_per_capita),
educ_jefe_0 = mfv(data_d$educ_jefe_0), educ_jefe_3 = mfv(data_d$educ_jefe_3),
educ_jefe_4 = mfv(data_d$educ_jefe_4), educ_jefe_5 = mfv(data_d$educ_jefe_5),
educ_jefe_6 = mfv(data_d$educ_jefe_6), educ_jefe_7 = mfv(data_d$educ_jefe_7),
jmujer = mfv(data_d$jmujer), ch11_0 = mfv(data_d$ch11_0), ch11_1 = mfv(data_d$ch11_1), ch11_9 = mfv(data_d$ch11_9)))
prueba3 <- margins(desercion_probit, at = list(mujer = mfv(data_d$mujer), educ_jefe = mfv(data_d$educ_jefe),
hermanos = mfv(data_d$hermanos), ingreso_per_capita = mfv(data_d$ingreso_per_capita),
educ_jefe_0 = mfv(data_d$educ_jefe_0), educ_jefe_3 = mfv(data_d$educ_jefe_3),
educ_jefe_4 = mfv(data_d$educ_jefe_4), educ_jefe_5 = mfv(data_d$educ_jefe_5),
educ_jefe_6 = mfv(data_d$educ_jefe_6), educ_jefe_7 = mfv(data_d$educ_jefe_7),
jmujer = mfv(data_d$jmujer), ch11_0 = mfv(data_d$ch11_0), ch11_1 = mfv(data_d$ch11_1), ch11_9 = mfv(data_d$ch11_9)))
desercion_mlp <- lm(modelo_desercion, data = data_d)
desercion_mlp_robust <- coeftest(desercion_mlp, vcov = vcovHC(desercion_mlp, "HC1"))
data_d$ingreso_per_capita[data_d$ingreso_per_capita == 0] <- 1
data_d$ln_ing <- log(data_d$ingreso_per_capita, base = exp(1))
stargazer(desercion_probit_robust, desercion_mlp_robust, type='text',
dep.var.labels=c("Deserta", "Deserta"),
notes = "Robust standard errors in parentheses")
ingreso <- seq(0,100000,100)
k <- length(ingreso)
ingreso <- seq(0,100000,100)
k <- length(ingreso)
pred_mujer <- predict(desercion_probit, newdata = data.frame(mujer=rep(1,k),
educ_jefe= rep(mean(data_d$educ_jefe), k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
educ_jefe_0 = rep(0,k),
educ_jefe_3 = rep(1,k),
educ_jefe_4 = rep(0,k),
educ_jefe_5 = rep(0,k),
educ_jefe_6 = rep(0,k),
educ_jefe_7 = rep(0,k),
jmujer= rep(1,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
pred_hombre <- predict(desercion_probit, newdata = data.frame(mujer=rep(0,k),
educ_jefe= rep(mean(data_d$educ_jefe), k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
educ_jefe_0 = rep(0,k),
educ_jefe_3 = rep(1,k),
educ_jefe_4 = rep(0,k),
educ_jefe_5 = rep(0,k),
educ_jefe_6 = rep(0,k),
educ_jefe_7 = rep(0,k),
jmujer= rep(1,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
pred_jm <- predict(desercion_probit, newdata = data.frame(mujer=rep(1,k),
educ_jefe= rep(mean(data_d$educ_jefe), k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
educ_jefe_0 = rep(0,k),
educ_jefe_3 = rep(1,k),
educ_jefe_4 = rep(0,k),
educ_jefe_5 = rep(0,k),
educ_jefe_6 = rep(0,k),
educ_jefe_7 = rep(0,k),
jmujer= rep(1,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
pred_jh <- predict(desercion_probit, newdata = data.frame(mujer=rep(1,k),
educ_jefe= rep(mean(data_d$educ_jefe), k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
educ_jefe_0 = rep(0,k),
educ_jefe_3 = rep(1,k),
educ_jefe_4 = rep(0,k),
educ_jefe_5 = rep(0,k),
educ_jefe_6 = rep(0,k),
educ_jefe_7 = rep(0,k),
jmujer= rep(0,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
df_final <- data.frame(
pred_jm, pred_jh, pred_hombre, pred_mujer)
ggplot()+
geom_line(data=df_final,aes(y=pred_jm,x= ingreso,colour="Mujer"),size=1 )+
geom_line(data=df_final,aes(y=pred_jh,x= ingreso,colour="Hombre"),size=1) +
scale_color_manual(name = "Jefe de hogar", values = c("Mujer" = "burlywood2", "Hombre" = "azure3"))+
ggtitle("Probabilidad de deserción en función del ingreso para jefes de hogar") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()
library(ggplot2)
ggplot()+
geom_line(data=df_final,aes(y=pred_jm,x= ingreso,colour="Mujer"),size=1 )+
geom_line(data=df_final,aes(y=pred_jh,x= ingreso,colour="Hombre"),size=1) +
scale_color_manual(name = "Jefe de hogar", values = c("Mujer" = "burlywood2", "Hombre" = "azure3"))+
ggtitle("Probabilidad de deserción en función del ingreso para jefes de hogar") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()
ggplot()+
geom_line(data=df_final,aes(y=pred_mujer,x= ingreso,colour="Mujer"),size=1 )+
geom_line(data=df_final,aes(y=pred_hombre,x= ingreso,colour="Hombre"),size=1) +
scale_color_manual(name = "Sexo", values = c("Mujer" = "burlywood2", "Hombre" = "azure3"))+
ggtitle("Probabilidad de deserción en función del ingreso para jefes de hogar") +
xlab("Ingreso per capita")+
ylab("Predicción")+
theme_bw()
