qplot(AÃ.o, London, data = Salarios, geom = c("point", "line"), colour =YEAR)
qplot(AÃ.o, London, data = Salarios, geom = c("point", "line"))
qplot(AÃ.o, London, data = Salarios, geom = c("point", "line")))
AÃ.o
qplot(Salarios$AÃ.o, Salarios$London, data = Salarios, geom = c("point", "line"), colour =YEAR)
qplot(Salarios$AÃ.o, Salarios$London, data = Salarios, geom = c("point", "line"), colour =YEAR)
qplot(Salarios$AÃ.o, Salarios$London, data = Salarios, geom = c("point", "line"), colour =YEAR)
qplot(Salarios$AÃ.o, Salarios$London, data = Salarios, geom = c("point", "line"), colour =YEAR))
qplot(Salarios$AÃ.o, Salarios$London, data = Salarios, geom = c("point", "line"), colour =Salarios$AÃ.o)
qplot(Salarios$AÃ.o, Salarios$London, data = Salarios, geom = c("point", "line"))
qplot(AÃ.o, London, data = Salarios, geom = c("point", "line"))
qplot(AÃ.o, London, data = Salarios, geom = c("point", "line"))
qplot(AÃ.o, London, data = Salarios, geom = c("point", "line"))
qplot(AÃ.o, London, data = Salarios, geom = c("point", "line"))
plot(x=as.factor(Salarios$AÃ.o), y=Salarios$London, xlab = "Años", ylab="Salarios", type="o", col="blue", ylim=c(3,15))
plot(x=as.factor(Salarios$AÃ.o), y=Salarios$London, xlab = "Años", ylab="Salarios", type="o", col="blue", ylim=c(3,15))
plot(x=as.factor(Salarios$AÃ.o), y=Salarios$London, xlab = "Años", ylab="Salarios", type="o", col="blue", ylim=c(3,15))
lines(Antwrep, type="o", col="red", ylim=c(3,15))
lines(Valencia, type="o", col="black", ylim=c(3,15))
title(main = "Salarios en Europa")
plot(x=as.factor(Salarios$AÃ.o), y=, xlab = "Años", ylab="Salarios", type="o", col="blue", ylim=c(3,15))
Salarios$London
plot(x=as.factor(Salarios$AÃ.o), y=Salarios$London, xlab = "Años", ylab="Salarios", type="o", col="blue", ylim=c(3,15))
lines(Antwrep, type="o", col="red", ylim=c(3,15))
lines(Valencia, type="o", col="black", ylim=c(3,15))
title(main = "Salarios en Europa")
Salarios<-DatosEjercitacion7[1:3,]
Salarios
Salarios<-DatosEjercitacion7[,1:3]
Salarios<-cbind(Salarios,DatosEjercitacion7$Valencia)
Salarios
qplot(AÃ.o, London, data = Salarios, geom = c("point", "line")))
qplot(AÃ.o, London, data = Salarios, geom = c("point", "line"))
plot(salarios$Año, salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
plot(Salarios$Año, Salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
plot(Salarios$AÃ.o, Salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
plot(Salarios$AÃ.o, Salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
lines(Antwrep, type="o", col="red", ylim=c(3,15))
lines(Valencia, type="o", col="black", ylim=c(3,15))
title(main = "Salarios en Europa")
lines(Antwrep, type="o", col="red", ylim=c(3,15))
lines(Valencia, type="o", col="black", ylim=c(3,15))
title(main = "Salarios en Europa")
plot(Salarios$AÃ.o, Salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
lines(Antwrep, type="o", col="red", ylim=c(3,15))
lines(Valencia, type="o", col="black", ylim=c(3,15))
title(main = "Salarios en Europa")
plot(Salarios$AÃ.o, Salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
lines(Antwrep, type="o", col="red", ylim=c(3,15))
lines(Valencia, type="o", col="black", ylim=c(3,15))
plot(Salarios$AÃ.o, Salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
par(new=T)
plot(Salarios$AÃ.o, Salarios$Antwrep, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
plot(Salarios$AÃ.o, Salarios$Antwrep, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
plot(Salarios$AÃ.o, Salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
plot(Salarios$AÃ.o, Salarios$Antwrep, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
Salarios$Antwrep
plot(Salarios$AÃ.o, Salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
par(new=T)
plot(Salarios$AÃ.o, Salarios$Antwerp, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
plot(Salarios$AÃ.o, Salarios$Antwerp, type = "o", col = "red", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
plot(Salarios$AÃ.o, Salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
par(new=T)
plot(Salarios$AÃ.o, Salarios$Antwerp, type = "o", col = "red", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
plot(Salarios$AÃ.o, Salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
par(new=T)
plot(Salarios$AÃ.o, Salarios$Antwerp, type = "o", col = "red", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
par(new=T)
plot(Salarios$AÃ.o, Salarios$`DatosEjercitacion7$Valencia`, type = "o", col = "red", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
plot(Salarios$AÃ.o, Salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
par(new=T)
plot(Salarios$AÃ.o, Salarios$Antwerp, type = "o", col = "red", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
par(new=T)
plot(Salarios$AÃ.o, Salarios$`DatosEjercitacion7$Valencia`, type = "o", col = "green", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
plot(Salarios$AÃ.o, Salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
par(new=T)
plot(Salarios$AÃ.o, Salarios$Antwerp, type = "o", col = "red", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
par(new=T)
plot(Salarios$AÃ.o, Salarios$`DatosEjercitacion7$Valencia`, type = "o", col = "green", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
plot(Salarios$AÃ.o, Salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
plot(Salarios$AÃ.o, Salarios$Antwerp, type = "o", col = "red", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
plot(Salarios$AÃ.o, Salarios$`DatosEjercitacion7$Valencia`, type = "o", col = "green", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
plot(Salarios$AÃ.o, Salarios$Antwerp, type = "o", col = "red", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
plot(Salarios$AÃ.o, Salarios$`DatosEjercitacion7$Valencia`, type = "o", col = "green", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
plot(Salarios$AÃ.o, Salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
par(new=T)
plot(Salarios$AÃ.o, Salarios$Antwerp, type = "o", col = "red", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
par(new=T)
plot(Salarios$AÃ.o, Salarios$`DatosEjercitacion7$Valencia`, type = "o", col = "green", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
Salarios$`DatosEjercitacion7$Valencia`
plot(Salarios$AÃ.o, Salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
par(new=T)
plot(Salarios$AÃ.o, Salarios$Antwerp, type = "o", col = "red")
par(new=T)
plot(Salarios$AÃ.o, Salarios$`DatosEjercitacion7$Valencia`, type = "o", col = "green")
plot(Salarios$AÃ.o, Salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
plot(Salarios$AÃ.o, Salarios$`DatosEjercitacion7$Valencia`, type = "o", col = "green")
par(new=T)
plot(Salarios$AÃ.o, Salarios$Antwerp, type = "o", col = "red")
plot(Salarios$AÃ.o, Salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
par(new=T)
plot(Salarios$AÃ.o, Salarios$Antwerp, type = "o", col = "red",ylab = "", xlab = "")
par(new=T)
plot(Salarios$AÃ.o, Salarios$`DatosEjercitacion7$Valencia`, type = "o", col = "green",ylab = "", xlab = "")
DatosEjercitacion7 <- read.csv("C:/Users/Abi/Desktop/DatosEjercitacion7.csv", sep=";")
View(DatosEjercitacion7)
Salarios<-DatosEjercitacion7
plot(salarios$Año, salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
salarios<-DatosEjercitacion7
plot(salarios$Año, salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
plot(salarios$Año, salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
lines(salarios$Año, salarios$Antwerp, type = "o", col = "red")
lines(salarios$Año, salarios$Valencia, type = "o", col = "black")
legend("topleft", legend = c("London", "Antwerp", "Valencia"), col = c("blue", "red", "black"), lty = 1:3)
plot(salarios$Año, salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
lines(salarios$Año, salarios$Antwerp, type = "o", col = "red")
lines(salarios$Año, salarios$Valencia, type = "o", col = "black")
legend("topleft", legend = c("London", "Antwerp", "Valencia"), col = c("blue", "red", "black"), lty = 1:3)
salarios<-DatosEjercitacion7
plot(salarios$Año, salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
lines(salarios$Año, salarios$Antwerp, type = "o", col = "red")
lines(salarios$Año, salarios$Valencia, type = "o", col = "black")
legend("topleft", legend = c("London", "Antwerp", "Valencia"), col = c("blue", "red", "black"), lty = 1:3)
plot(salarios$Año, salarios$London, type = "o", col = "blue", main = "Salarios en Europa", ylab = "Salarios", xlab = "Años")
lines(salarios$Año, salarios$Antwerp, type = "o", col = "red")
lines(salarios$Año, salarios$Valencia, type = "o", col = "black")
legend("topleft", legend = c("London", "Antwerp", "Valencia"), col = c("blue", "red", "black"), lty = 1:3)
x <- sec(-6,6,0.01)
y <- exp(x)/(1+exp(x))
x <- sec(-6,6,0.01)
x <- seq(-6,6,0.01)
y <- exp(x)/(1+exp(x))
library(ggplot2)
library(ggfortify)
library(forecast)
autoplot(x,y, ts.colour = colores[1]) +
ggtitle("Evolución del sentimiento de Alberto Fernández") +
xlab("Tiempo") +
ylab("Sentimiento") +
theme_minimal() +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
labs(x = "Tiempo",
y = "Sentimiento",
title = "Evolución del sentimiento de Alberto Fernández",
caption = "Fuente: elaboración propia")
autoplot(x,y) +
theme_minimal()
autoplot(x,y) +
theme_minimal()
data<-cbind(x,y)
data1<-cbind(x,y)
x1 <- seq(-6,6,0.01)
y1 <- exp(x)/(1+exp(x))
data1<-cbind(x1,y1)
ggplot(data=data1, aes(x=x1, y=y1, group=1)) +
geom_line(color="red")+
geom_point()
ggplot(data=data1, aes(x=x1, y=y1, group=1)) +
geom_line(color="red")+
theme_minimal() +
geom_point()
ggplot(data=data1, aes(x=x1, y=y1, group=1)) +
geom_line(color="pink")+
theme_minimal() +
geom_point()
ggplot(data=data1, aes(x=x1, y=y1, group=1)) +
geom_line(color="pink")+
theme_minimal() +
a
ggplot(data=data1, aes(x=x1, y=y1, group=1)) +
geom_line(color="pink")+
theme_minimal() +
geom_point()
ggplot(data=data1, aes(x=x1, y=y1)) +
geom_line(color="pink")+
theme_minimal() +
geom_point()
ggplot(data=data1, aes(x=x1, y=y1)) +
geom_line(color="pink")+
scale_color_manual(values=c("#999999"))
theme_minimal() +
geom_point()
ggplot(data=data1, aes(x=x1, y=y1)) +
geom_line(color="pink")+
scale_color_manual(values=c("#4b4b4b"))
theme_minimal() +
geom_point()
ggplot(data=data1, aes(x=x1, y=y1)) +
geom_line(color="pink")+
scale_color_manual(values=c("#4b4b4b"))+
theme_minimal() +
geom_point()
ggplot(data=data1, aes(x=x1, y=y1)) +
geom_line(color="pink")+
theme_minimal() +
scale_color_manual(values=c("#4b4b4b"))+
geom_point()
Who.exported.Vehicles.between.1995.and.2015_ <- read.csv("C:/Users/Abi/Desktop/Who exported Vehicles between 1995 and 2015_.csv")
View(Who.exported.Vehicles.between.1995.and.2015_)
data(BostonHousing)
data(BostonHousing2)
data(BostonHousing)
data(BostonHousing2)
library(haven)
data <- read_dta("https://econometriaudesa.weebly.com/uploads/1/3/6/3/136372338/cuarto_trim_2019.dta")
library(fastDummies)
data_d <- dummy_cols(data, select_columns = "ch11")
data_d <- dummy_cols(data_d, select_columns = "educ_jefe")
data_d <- data_d[data_d$ingreso_per_capita > 1, ]
library(ggplot2)
library(dplyr)
library(Formula)
modelo_desercion <- Formula(deserta ~ mujer + educ_jefe_0 + educ_jefe_3 + educ_jefe_4 + educ_jefe_5 +
educ_jefe_6 + educ_jefe_7 + hermanos + ingreso_per_capita + jmujer +
ch11_0 + ch11_1 + ch11_9)
desercion_probit <- glm(modelo_desercion , family = binomial(link = "probit"),
data = data_d)
library(lmtest)
library(sandwich)
library(mfx)
library(margins)
desercion_probit_robust <-  coeftest(desercion_probit, vcov = vcovHC(desercion_probit, "HC1"))
desercion_probit_robust
desercion_mlp <- lm(modelo_desercion, data = data_d)
desercion_mlp_robust <- coeftest(desercion_mlp, vcov = vcovHC(desercion_mlp, "HC1"))
data_d$ln_ing <- log(data_d$ingreso_per_capita, base = exp(1))
ingreso <- seq(0,100000,100)
k <- length(ingreso)
pred_mujer <- predict(desercion_probit, newdata = data.frame(mujer=rep(1,k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
educ_jefe_0 = rep(0,k),
educ_jefe_3 = rep(1,k),
educ_jefe_4 = rep(0,k),
educ_jefe_5 = rep(0,k),
educ_jefe_6 = rep(0,k),
educ_jefe_7 = rep(0,k),
jmujer= rep(1,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
pred_hombre <- predict(desercion_probit, newdata = data.frame(mujer=rep(0,k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
educ_jefe_0 = rep(0,k),
educ_jefe_3 = rep(1,k),
educ_jefe_4 = rep(0,k),
educ_jefe_5 = rep(0,k),
educ_jefe_6 = rep(0,k),
educ_jefe_7 = rep(0,k),
jmujer= rep(1,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
pred_jm <- predict(desercion_probit, newdata = data.frame(mujer=rep(1,k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
educ_jefe_0 = rep(0,k),
educ_jefe_3 = rep(1,k),
educ_jefe_4 = rep(0,k),
educ_jefe_5 = rep(0,k),
educ_jefe_6 = rep(0,k),
educ_jefe_7 = rep(0,k),
jmujer= rep(1,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
pred_jh <- predict(desercion_probit, newdata = data.frame(mujer=rep(1,k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
educ_jefe_0 = rep(0,k),
educ_jefe_3 = rep(1,k),
educ_jefe_4 = rep(0,k),
educ_jefe_5 = rep(0,k),
educ_jefe_6 = rep(0,k),
educ_jefe_7 = rep(0,k),
jmujer= rep(0,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
df_final <- data.frame(
pred_jm, pred_jh, pred_hombre, pred_mujer)
ggplot()+
geom_line(data=df_final,aes(y=pred_jm,x= ingreso,colour="Mujer"),size=1 )+
geom_line(data=df_final,aes(y=pred_jh,x= ingreso,colour="Hombre"),size=1) +
scale_color_manual(name = "Jefe de hogar", values = c("Mujer" = "burlywood2", "Hombre" = "azure3"))+
ggtitle("Probabilidad de deserci?n en funci?n del ingreso para jefes de hogar") +
xlab("Ingreso per capita")+
ylab("Predicci?n")+
theme_bw()
pred_hombre <- predict(desercion_probit, newdata = data.frame(mujer=rep(0,k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
educ_jefe_0 = rep(0,k),
educ_jefe_3 = rep(1,k),
educ_jefe_4 = rep(0,k),
educ_jefe_5 = rep(0,k),
educ_jefe_6 = rep(0,k),
educ_jefe_7 = rep(0,k),
jmujer= rep(1,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
modelo_desercion <- Formula(deserta ~ mujer + educ_jefe_0 + educ_jefe_3 + educ_jefe_4 + educ_jefe_5 +
educ_jefe_6 + educ_jefe_7 + hermanos + ingreso_per_capita + jmujer +
ch11_0 + ch11_1 + ch11_9)
desercion_probit <- glm(modelo_desercion , family = binomial(link = "probit"),
data = data_d)
data_d$ln_ing <- log(data_d$ingreso_per_capita, base = exp(1))
ingreso <- seq(0,100000,100)
k <- length(ingreso)
pred_mujer <- predict(desercion_probit, newdata = data.frame(mujer=rep(1,k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
educ_jefe_0 = rep(0,k),
educ_jefe_3 = rep(1,k),
educ_jefe_4 = rep(0,k),
educ_jefe_5 = rep(0,k),
educ_jefe_6 = rep(0,k),
educ_jefe_7 = rep(0,k),
jmujer= rep(1,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
pred_hombre <- predict(desercion_probit, newdata = data.frame(mujer=rep(0,k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
educ_jefe_0 = rep(0,k),
educ_jefe_3 = rep(1,k),
educ_jefe_4 = rep(0,k),
educ_jefe_5 = rep(0,k),
educ_jefe_6 = rep(0,k),
educ_jefe_7 = rep(0,k),
jmujer= rep(1,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
pred_jm <- predict(desercion_probit, newdata = data.frame(mujer=rep(1,k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
educ_jefe_0 = rep(0,k),
educ_jefe_3 = rep(1,k),
educ_jefe_4 = rep(0,k),
educ_jefe_5 = rep(0,k),
educ_jefe_6 = rep(0,k),
educ_jefe_7 = rep(0,k),
jmujer= rep(1,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
pred_jh <- predict(desercion_probit, newdata = data.frame(mujer=rep(1,k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
educ_jefe_0 = rep(0,k),
educ_jefe_3 = rep(1,k),
educ_jefe_4 = rep(0,k),
educ_jefe_5 = rep(0,k),
educ_jefe_6 = rep(0,k),
educ_jefe_7 = rep(0,k),
jmujer= rep(0,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
ingreso <- seq(0,100000,100)
k <- length(ingreso)
pred_mujer <- predict(desercion_probit, newdata = data.frame(mujer=rep(1,k),
hermanos = rep(mean(data_d$hermanos), k),
ingreso_per_capita=ingreso,
educ_jefe_0 = rep(0,k),
educ_jefe_3 = rep(1,k),
educ_jefe_4 = rep(0,k),
educ_jefe_5 = rep(0,k),
educ_jefe_6 = rep(0,k),
educ_jefe_7 = rep(0,k),
jmujer= rep(1,k),
ch11_0= rep(1,k),
ch11_1=rep(0,k),
ch11_9=rep(0,k), type="response"))
ch11_9=(0))
newvalues <- with(data_d, data.frame(mujer=(1),
hermanos = mean(data_d$hermanos),
ingreso_per_capita=(1000),
educ_jefe_0 = (0),
educ_jefe_3 = (1),
educ_jefe_4 = (0),
educ_jefe_5 = (0),
educ_jefe_6 = (0),
educ_jefe_7 = (0),
jmujer=(1),
ch11_0=(1),
ch11_1=(0),
ch11_9=(0)))
predict(desercion_probit, newvalues, type="response")
newvalues <- with(data_d, data.frame(mujer=(1),
hermanos = mean(data_d$hermanos),
ingreso_per_capita=(0),
educ_jefe_0 = (0),
educ_jefe_3 = (1),
educ_jefe_4 = (0),
educ_jefe_5 = (0),
educ_jefe_6 = (0),
educ_jefe_7 = (0),
jmujer=(1),
ch11_0=(1),
ch11_1=(0),
ch11_9=(0)))
predict(desercion_probit, newvalues, type="response")
dir <- "/Users/Abi/Documents/GitHub/PsMetricsIV"
setwd(dir)
library(haven)
data <- read_dta("https://econometriaudesa.weebly.com/uploads/1/3/6/3/136372338/cuarto_trim_2019.dta")
library(fastDummies)
data_d <- dummy_cols(data, select_columns = "ch11")
data_d <- dummy_cols(data_d, select_columns = "educ_jefe")
data_d <- data_d[data_d$ingreso_per_capita > 1, ]
library(ggplot2)
library(dplyr)
g1 <- ggplot(data_d, aes(x=`ingreso_per_capita`, group=`deserta`, color=factor(`deserta`)))+
geom_density(adjust=2, size = 0.75) +
geom_vline(aes(xintercept = mean(ingreso_per_capita)),
linetype = "dashed", size = 0.6) +
xlab("Ingreso per cÃ¡pita") +
ylab("Densidad")+
theme_minimal() +
ggtitle("Densidad del ingreso per cÃ¡pita")+
scale_colour_manual(
values = c("burlywood2", "azure3"),
labels = c("No", "Si"),
name = "Deserta")+
theme(
legend.key.size = unit(0.5, "cm"),
legend.key.width = unit(0.5,"cm"),
plot.title = element_text(hjust = 0.5)
)
g2 <- ggplot(data_d, aes(x=`hermanos`, group=`deserta`, color=factor(`deserta`)))+
geom_histogram(size = 0.75, fill="white") +
geom_vline(aes(xintercept = mean(hermanos)),
linetype = "dashed", size = 0.6) +
xlab("Cantidad de hermanos") +
ylab("Frecuencia")+
theme_minimal() +
ggtitle("Histograma de la cantidad de hermanos")+
scale_colour_manual(
values = c("burlywood2", "azure3"),
labels = c("No", "Si"),
name = "Deserta") +
theme(plot.title = element_text(hjust = 0.5))
data_d$educ_lab[data_d$educ_jefe == 0] = "Missing"
data_d$educ_lab[data_d$educ_jefe == 2] = "Primaria"
data_d$educ_lab[data_d$educ_jefe == 3] = "EGB"
data_d$educ_lab[data_d$educ_jefe == 4] = "Secundaria"
data_d$educ_lab[data_d$educ_jefe == 5] = "Polimodal"
data_d$educ_lab[data_d$educ_jefe == 6] = "Terciaria"
data_d$educ_lab[data_d$educ_jefe == 7] = "Universitaria"
data_d$educ_lab[data_d$educ_jefe == 8] = "Posgrado"
data_d$deserta_lab <- ""
data_d$deserta_lab[data_d$deserta == 1] = "Si"
data_d$deserta_lab[data_d$deserta == 0] = "No"
g3 <- ggplot(data_d, mapping = aes(x = educ_lab,
y = after_stat(count/sum(count)),
fill = deserta_lab)) +
geom_bar() +
scale_fill_manual( values = c("burlywood2", "azure3"),
labels = c("No", "Si"),
name = "Deserta") +
theme_minimal() +
coord_flip() +
xlab("EducaciÃ³n") +
ylab("% Sobre el total") +
ggtitle("Nivel educativo del jefe de hogar") +
theme(legend.position = "right",
plot.title = element_text(hjust = 0.5))
library(gridExtra)
grid.arrange(g1, g2, g3, nrow = 3, ncol = 1)
library(stargazer)
data_stuct <- data.frame(data_d)
stargazer(data_stuct[c("deserta", "mujer",
"jmujer", "ingreso_per_capita")],
type="latex")
library(Formula)
modelo_desercion <- Formula(deserta ~ mujer + educ_jefe_0 + educ_jefe_3 + educ_jefe_4 + educ_jefe_5 +
educ_jefe_6 + educ_jefe_7 + educ_jefe_8 + hermanos + ingreso_per_capita + jmujer +
ch11_0 + ch11_1 + ch11_9)
desercion_probit <- glm(modelo_desercion , family = binomial(link = "probit"),
data = data_d)
library(lmtest)
library(sandwich)
library(mfx)
library(margins)
desercion_probit_robust <-  coeftest(desercion_probit, vcov = vcovHC(desercion_probit, "HC1"))
desercion_probit_robust
marginal_media <- probitmfx(deserta ~ mujer + educ_jefe_0 + educ_jefe_3 + educ_jefe_4 + educ_jefe_5 +
educ_jefe_6 + educ_jefe_7 + educ_jefe_8 + hermanos + ingreso_per_capita +
jmujer + ch11_0 + ch11_1 + ch11_9, data = data_d,
atmean = TRUE, robust = TRUE)
prueba1 <- margins(desercion_probit, at = list(mujer = 0:1))
prueba2 <- margins(desercion_probit, at = list(mujer = median(data_d$mujer),
educ_jefe = median(data_d$educ_jefe),
hermanos = median(data_d$hermanos),
educ_jefe_0 = median(data_d$educ_jefe_0),
educ_jefe_3 = median(data_d$educ_jefe_3),
educ_jefe_4 = median(data_d$educ_jefe_4),
educ_jefe_5 = median(data_d$educ_jefe_5),
educ_jefe_6 = median(data_d$educ_jefe_6),
educ_jefe_7 = median(data_d$educ_jefe_7),
educ_jefe_8 = median(data_d$educ_jefe_8),
ingreso_per_capita = median(data_d$ingreso_per_capita),
jmujer = median(data_d$jmujer),
ch11_0 = median(data_d$ch11_0),
ch11_1 = median(data_d$ch11_1),
ch11_9 = median(data_d$ch11_9)))
